{% comment %}
  Featured Products Section
{% endcomment %}

{%- style -%}
  .featured-products {
    padding: 6rem 2rem;
    background-color: rgb(var(--white));
  }

  @media screen and (min-width: 750px) {
    .featured-products {
      padding: 8rem 4rem;
    }
  }

  .featured-products__header {
    text-align: center;
    margin-bottom: 4rem;
  }

  .featured-products__title {
    font-size: 3.6rem;
    font-weight: 700;
    color: rgb(var(--black));
    text-transform: uppercase;
    letter-spacing: 0.2rem;
    margin-bottom: 1rem;
  }

  .featured-products__subtitle {
    font-size: 1.6rem;
    color: rgba(var(--black), 0.7);
    max-width: 600px;
    margin: 0 auto;
  }

  .featured-products__grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 3rem;
    max-width: var(--page-width);
    margin: 0 auto;
  }

  @media screen and (max-width: 749px) {
    .featured-products__grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
    }
  }

  .product-card {
    position: relative;
    text-align: center;
    transition: transform 0.3s ease;
    background-color: rgb(var(--white));
    border: 1px solid rgba(var(--black), 0.1);
    overflow: hidden;
  }

  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  }

  .product-card__image-wrapper {
    position: relative;
    width: 100%;
    padding-top: 120%;
    overflow: hidden;
    background-color: rgba(var(--black), 0.05);
  }

  .product-card__image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .product-card:hover .product-card__image {
    transform: scale(1.05);
  }

  .product-card__badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background-color: rgb(var(--gold));
    color: rgb(var(--black));
    padding: 0.5rem 1rem;
    font-size: 1.2rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05rem;
  }

  .product-card__content {
    padding: 2rem 1.5rem;
  }

  .product-card__title {
    font-size: 1.6rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: rgb(var(--black));
  }

  .product-card__title a {
    text-decoration: none;
    color: inherit;
    transition: color 0.3s ease;
  }

  .product-card__title a:hover {
    color: rgb(var(--gold));
  }

  .product-card__vendor {
    font-size: 1.2rem;
    color: rgba(var(--black), 0.6);
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 0.05rem;
  }

  .product-card__price {
    font-size: 1.8rem;
    font-weight: 700;
    color: rgb(var(--gold));
    margin-bottom: 1.5rem;
  }

  .product-card__price--compare {
    text-decoration: line-through;
    color: rgba(var(--black), 0.4);
    font-size: 1.4rem;
    margin-right: 0.5rem;
  }

  .product-card__button {
    width: 100%;
    padding: 1rem;
    background-color: rgb(var(--black));
    color: rgb(var(--white));
    border: 2px solid rgb(var(--black));
    font-size: 1.4rem;
    font-weight: 700;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .product-card__button:hover {
    background-color: rgb(var(--gold));
    border-color: rgb(var(--gold));
    color: rgb(var(--black));
  }
{%- endstyle -%}

<section class="featured-products">
  <div class="featured-products__header">
    {%- if section.settings.title != blank -%}
      <h2 class="featured-products__title">{{ section.settings.title }}</h2>
    {%- endif -%}
    {%- if section.settings.subtitle != blank -%}
      <p class="featured-products__subtitle">{{ section.settings.subtitle }}</p>
    {%- endif -%}
  </div>

  {%- liquid
    assign products_to_display = section.settings.products_to_show | default: 4
    assign collection = collections[section.settings.collection]
  -%}

  <div class="featured-products__grid">
    {%- if collection != blank and collection.products.size > 0 -%}
      {%- for product in collection.products limit: products_to_display -%}
        <div class="product-card">
          <div class="product-card__image-wrapper">
            {%- if product.featured_media -%}
              <img src="{{ product.featured_media | image_url: width: 600 }}"
                   srcset="{{ product.featured_media | image_url: width: 300 }} 300w,
                           {{ product.featured_media | image_url: width: 600 }} 600w"
                   sizes="(min-width: 750px) calc((100vw - 10rem) / 4), calc((100vw - 3rem) / 2)"
                   alt="{{ product.featured_media.alt | escape }}"
                   class="product-card__image"
                   loading="lazy">
            {%- else -%}
              {{ 'product-1' | placeholder_svg_tag: 'product-card__image' }}
            {%- endif -%}

            {%- if product.compare_at_price > product.price -%}
              <span class="product-card__badge">Sale</span>
            {%- endif -%}
          </div>

          <div class="product-card__content">
            {%- if product.vendor != blank -%}
              <div class="product-card__vendor">{{ product.vendor }}</div>
            {%- endif -%}

            <h3 class="product-card__title">
              <a href="{{ product.url }}">{{ product.title }}</a>
            </h3>

            <div class="product-card__price">
              {%- if product.compare_at_price > product.price -%}
                <span class="product-card__price--compare">{{ product.compare_at_price | money }}</span>
              {%- endif -%}
              <span>{{ product.price | money }}</span>
            </div>

            <form method="post" action="/cart/add" accept-charset="UTF-8" class="product-card__form" enctype="multipart/form-data">
              <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
              <button type="submit" name="add" class="product-card__button" {% unless product.available %}disabled{% endunless %}>
                {%- if product.available -%}
                  {{ 'products.product.add_to_cart' | t }}
                {%- else -%}
                  {{ 'products.product.sold_out' | t }}
                {%- endif -%}
              </button>
            </form>
          </div>
        </div>
      {%- endfor -%}
    {%- else -%}
      {%- for i in (1..products_to_display) -%}
        <div class="product-card">
          <div class="product-card__image-wrapper">
            {{ 'product-1' | placeholder_svg_tag: 'product-card__image' }}
          </div>
          <div class="product-card__content">
            <h3 class="product-card__title">
              <a href="#">{{ 'onboarding.product_title' | t }}</a>
            </h3>
            <div class="product-card__price">$99.99</div>
            <button type="button" class="product-card__button">
              {{ 'products.product.add_to_cart' | t }}
            </button>
          </div>
        </div>
      {%- endfor -%}
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "t:sections.featured-products.name",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "default": "Featured Products",
      "label": "t:sections.featured-products.settings.title.label"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "default": "Handpicked selection of our finest spirits",
      "label": "t:sections.featured-products.settings.subtitle.label"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "t:sections.featured-products.settings.collection.label"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 4,
      "label": "t:sections.featured-products.settings.products_to_show.label"
    }
  ],
  "presets": [
    {
      "name": "t:sections.featured-products.presets.name"
    }
  ]
}
{% endschema %}
