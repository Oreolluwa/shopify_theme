{% comment %}
  Premium Header Section - Sticky transparent navigation
  Features:
  - Transparent background that fades in on scroll
  - Smooth hover animations
  - Mobile-first responsive design
  - High-end typography and spacing
{% endcomment %}

<link rel="stylesheet" href="{{ 'premium-header.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-cart-notification.css' | asset_url }}" media="print" onload="this.media='all'">

{%- style -%}
  {% if section.settings.transparent_header %}
    .header-wrapper {
      background-color: {{ section.settings.header_bg_color | color_modify: 'alpha', 0 }};
    }
  {% else %}
    .header-wrapper {
      background-color: {{ section.settings.header_bg_color }};
    }
  {% endif %}
  
  .header__heading-link {
    color: {{ section.settings.header_text_color }};
  }
  
  .header__menu-item {
    color: {{ section.settings.header_text_color }};
  }
  
  .header__icon {
    color: {{ section.settings.header_text_color }};
  }
  
  {% if section.settings.transparent_header %}
    .header-wrapper.scrolled {
      background-color: {{ section.settings.header_bg_scrolled | color_modify: 'alpha', 0.98 }};
    }
    
    .header-wrapper.scrolled .header__heading-link,
    .header-wrapper.scrolled .header__menu-item,
    .header-wrapper.scrolled .header__icon {
      color: {{ section.settings.header_text_scrolled }};
    }
  {% endif %}
{%- endstyle -%}

<script src="{{ 'details-disclosure.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'details-modal.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'cart-notification.js' | asset_url }}" defer="defer"></script>

<div class="shopify-section-header-wrapper">
  <div class="header-wrapper{% if section.settings.transparent_header %} transparent{% endif %}">
    <header class="header page-width">
      {%- if section.settings.menu != blank -%}
        <button type="button" class="header__icon header-menu-mobile-toggle" aria-controls="mobile-menu-drawer" aria-label="Open menu">
          {% render 'icon-hamburger' %}
        </button>
      {%- endif -%}

      <div class="header__heading">
        {%- if section.settings.logo != blank -%}
          <a href="{{ routes.root_url }}" class="header__heading-link">
            <img src="{{ section.settings.logo | image_url: width: section.settings.logo_width }}"
                 srcset="{{ section.settings.logo | image_url: width: section.settings.logo_width }} 1x, 
                         {{ section.settings.logo | image_url: width: section.settings.logo_width, scale: 2 }} 2x"
                 alt="{{ shop.name | escape }}"
                 width="{{ section.settings.logo_width }}"
                 height="{{ section.settings.logo_width | divided_by: section.settings.logo.aspect_ratio | round }}"
                 class="header__heading-logo"
                 loading="eager">
          </a>
        {%- else -%}
          <a href="{{ routes.root_url }}" class="header__heading-link">
            {{ shop.name }}
          </a>
        {%- endif -%}
      </div>

      {%- if section.settings.menu != blank -%}
        <nav class="header__inline-menu" aria-label="Primary navigation">
          <ul class="list-menu" role="list">
            {%- for link in section.settings.menu.links -%}
              <li>
                <a href="{{ link.url }}" 
                   class="header__menu-item hover-underline"
                   {% if link.current %}aria-current="page"{% endif %}>
                  {{ link.title | escape }}
                </a>
              </li>
            {%- endfor -%}
          </ul>
        </nav>
      {%- endif -%}

      <div class="header__icons">
        {%- if section.settings.enable_customer_avatar -%}
          <a href="{{ routes.account_url }}" class="header__icon" aria-label="Account">
            {% render 'icon-account' %}
          </a>
        {%- endif -%}

        {%- if section.settings.enable_search -%}
          <button type="button" class="header__icon" aria-label="Search" data-search-modal-toggle>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </button>
        {%- endif -%}

        <a href="{{ routes.cart_url }}" class="header__icon" id="cart-icon-bubble" aria-label="Cart">
          {% render 'icon-cart' %}
          <span class="cart-count-bubble{% if cart == empty %} visually-hidden{% endif %}">
            <span aria-hidden="true">{{ cart.item_count }}</span>
            <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
          </span>
        </a>
      </div>
    </header>
  </div>
</div>

{%- if section.settings.menu != blank -%}
  <div class="mobile-menu-overlay"></div>
  <menu-drawer class="mobile-menu-drawer">
    <details id="mobile-menu-drawer" class="mobile-menu-drawer__container">
      <summary class="mobile-menu-drawer__header">
        <span class="mobile-menu-drawer__title">{{ 'sections.header.menu' | t }}</span>
        <button type="button" class="mobile-menu-drawer__close-button" aria-label="Close menu">
          {% render 'icon-close' %}
        </button>
      </summary>
      <div class="mobile-menu-drawer__content">
        <nav class="mobile-menu-drawer__navigation" aria-label="Mobile navigation">
          <ul class="mobile-menu" role="list">
            {%- for link in section.settings.menu.links -%}
              <li>
                <a href="{{ link.url }}" 
                   class="mobile-menu__link"
                   {% if link.current %}aria-current="page"{% endif %}>
                  {{ link.title | escape }}
                </a>
              </li>
            {%- endfor -%}
          </ul>
        </nav>
      </div>
    </details>
  </menu-drawer>
{%- endif -%}

<script>
  // Premium Header Scroll Effect
  (function() {
    const header = document.querySelector('.header-wrapper');
    const mobileOverlay = document.querySelector('.mobile-menu-overlay');
    const mobileDrawer = document.querySelector('#mobile-menu-drawer');
    const mobileToggle = document.querySelector('.header-menu-mobile-toggle');
    
    if (header) {
      let lastScroll = 0;
      
      window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
        
        lastScroll = currentScroll;
      });
    }
    
    // Mobile menu functionality
    if (mobileToggle && mobileDrawer && mobileOverlay) {
      mobileToggle.addEventListener('click', function() {
        mobileDrawer.setAttribute('open', '');
        mobileOverlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      });
      
      const closeMenu = function() {
        mobileDrawer.removeAttribute('open');
        mobileOverlay.classList.remove('active');
        document.body.style.overflow = '';
      };
      
      mobileOverlay.addEventListener('click', closeMenu);
      
      const closeButton = document.querySelector('.mobile-menu-drawer__close-button');
      if (closeButton) {
        closeButton.addEventListener('click', closeMenu);
      }
      
      // Close on link click
      const mobileLinks = document.querySelectorAll('.mobile-menu__link');
      mobileLinks.forEach(link => {
        link.addEventListener('click', closeMenu);
      });
    }
  })();
</script>

{% schema %}
{
  "name": "Header",
  "class": "section-header",
  "settings": [
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 80,
      "max": 300,
      "step": 10,
      "default": 180,
      "unit": "px",
      "label": "Logo width"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "header",
      "content": "Transparency & Scroll Effects"
    },
    {
      "type": "checkbox",
      "id": "transparent_header",
      "default": true,
      "label": "Enable transparent header",
      "info": "Header will be transparent on page load and solid on scroll"
    },
    {
      "type": "color",
      "id": "header_bg_color",
      "default": "#000000",
      "label": "Header background (initial)"
    },
    {
      "type": "color",
      "id": "header_bg_scrolled",
      "default": "#FFFFFF",
      "label": "Header background (scrolled)"
    },
    {
      "type": "color",
      "id": "header_text_color",
      "default": "#FFFFFF",
      "label": "Text color (initial)"
    },
    {
      "type": "color",
      "id": "header_text_scrolled",
      "default": "#000000",
      "label": "Text color (scrolled)"
    },
    {
      "type": "header",
      "content": "Features"
    },
    {
      "type": "checkbox",
      "id": "enable_customer_avatar",
      "default": true,
      "label": "Show account link"
    },
    {
      "type": "checkbox",
      "id": "enable_search",
      "default": true,
      "label": "Show search icon"
    }
  ]
}
{% endschema %}
