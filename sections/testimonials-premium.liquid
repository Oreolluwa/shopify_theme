{% comment %}
  Premium Testimonials Section
  
  Design Philosophy:
  - Clean, sophisticated testimonial cards
  - Avatar images for authenticity
  - Star ratings optional
  - Carousel or grid layout
  - Premium wine/spirits aesthetic
  
  Use Cases:
  - Customer reviews
  - Expert endorsements
  - Press quotes
  - Industry awards
{% endcomment %}

{%- liquid
  assign layout_style = section.settings.layout_style | default: 'grid'
-%}

{%- style -%}
  .testimonials-{{ section.id }} {
    background-color: {{ section.settings.background_color }};
    padding: var(--spacing-2xl) 0;
  }

  @media screen and (max-width: 749px) {
    .testimonials-{{ section.id }} {
      padding: var(--spacing-xl) 0;
    }
  }

  .testimonials__header {
    text-align: {{ section.settings.text_alignment }};
    margin-bottom: var(--spacing-xl);
  }

  .testimonials__eyebrow {
    font-size: var(--text-xs);
    font-weight: 600;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: {{ section.settings.eyebrow_color }};
    margin-bottom: var(--spacing-sm);
  }

  .testimonials__heading {
    font-size: clamp(2.4rem, 4vw, {{ section.settings.heading_size }}px);
    font-weight: 600;
    color: {{ section.settings.heading_color }};
    margin-bottom: var(--spacing-md);
  }

  .testimonials__description {
    font-size: var(--text-lg);
    color: {{ section.settings.text_color }};
    max-width: 700px;
    {% if section.settings.text_alignment == 'center' %}
      margin: 0 auto;
    {% endif %}
    line-height: var(--leading-relaxed);
  }

  .testimonials__grid {
    display: grid;
    gap: {{ section.settings.grid_gap }}px;
    grid-template-columns: 1fr;
  }

  @media screen and (min-width: 750px) {
    .testimonials__grid {
      grid-template-columns: repeat({{ section.settings.columns_desktop }}, 1fr);
    }
  }

  .testimonial-card {
    background-color: {{ section.settings.card_bg_color }};
    padding: var(--spacing-lg);
    border: 1px solid {{ section.settings.card_border_color }};
    {% if section.settings.card_style == 'rounded' %}
      border-radius: 8px;
    {% elsif section.settings.card_style == 'shadow' %}
      box-shadow: var(--shadow-md);
      border: none;
    {% endif %}
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    transition: all var(--transition-base);
  }

  {% if section.settings.enable_hover_effect %}
    .testimonial-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }
  {% endif %}

  .testimonial-card__rating {
    display: flex;
    gap: 0.4rem;
    color: {{ section.settings.star_color }};
  }

  .testimonial-card__rating svg {
    width: 18px;
    height: 18px;
  }

  .testimonial-card__quote {
    font-size: var(--text-lg);
    line-height: var(--leading-relaxed);
    color: {{ section.settings.quote_color }};
    font-style: italic;
    position: relative;
  }

  .testimonial-card__quote::before {
    content: '"';
    font-size: 4rem;
    line-height: 0;
    position: absolute;
    top: 1.5rem;
    left: -1rem;
    color: {{ section.settings.quote_mark_color }};
    opacity: 0.3;
  }

  .testimonial-card__author {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    margin-top: auto;
  }

  .testimonial-card__avatar {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    object-fit: cover;
    background-color: {{ section.settings.avatar_bg_color }};
  }

  .testimonial-card__avatar-placeholder {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background-color: {{ section.settings.avatar_bg_color }};
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    font-weight: 600;
    color: {{ section.settings.avatar_text_color }};
  }

  .testimonial-card__author-info {
    flex: 1;
  }

  .testimonial-card__name {
    font-size: var(--text-base);
    font-weight: 600;
    color: {{ section.settings.author_name_color }};
    margin-bottom: 0.2rem;
  }

  .testimonial-card__title {
    font-size: var(--text-sm);
    color: {{ section.settings.author_title_color }};
  }
{%- endstyle -%}

<section class="testimonials-{{ section.id }} section">
  <div class="page-width">
    {%- if section.settings.eyebrow != blank or section.settings.heading != blank or section.settings.description != blank -%}
      <div class="testimonials__header">
        {%- if section.settings.eyebrow != blank -%}
          <p class="testimonials__eyebrow">{{ section.settings.eyebrow }}</p>
        {%- endif -%}

        {%- if section.settings.heading != blank -%}
          <h2 class="testimonials__heading">{{ section.settings.heading }}</h2>
        {%- endif -%}

        {%- if section.settings.description != blank -%}
          <div class="testimonials__description">{{ section.settings.description }}</div>
        {%- endif -%}
      </div>
    {%- endif -%}

    <div class="testimonials__grid">
      {%- for block in section.blocks -%}
        <div class="testimonial-card" {{ block.shopify_attributes }}>
          {%- if section.settings.show_ratings and block.settings.rating > 0 -%}
            <div class="testimonial-card__rating">
              {%- for i in (1..5) -%}
                {%- if i <= block.settings.rating -%}
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                {%- else -%}
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="none" stroke="currentColor">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                {%- endif -%}
              {%- endfor -%}
            </div>
          {%- endif -%}

          {%- if block.settings.quote != blank -%}
            <blockquote class="testimonial-card__quote">
              {{ block.settings.quote }}
            </blockquote>
          {%- endif -%}

          <div class="testimonial-card__author">
            {%- if block.settings.avatar != blank -%}
              {{
                block.settings.avatar |
                image_url: width: 112 |
                image_tag:
                  loading: 'lazy',
                  width: 56,
                  height: 56,
                  alt: block.settings.author_name | escape,
                  class: 'testimonial-card__avatar'
              }}
            {%- elsif block.settings.author_name != blank -%}
              <div class="testimonial-card__avatar-placeholder">
                {{ block.settings.author_name | slice: 0 }}
              </div>
            {%- endif -%}

            <div class="testimonial-card__author-info">
              {%- if block.settings.author_name != blank -%}
                <p class="testimonial-card__name">{{ block.settings.author_name }}</p>
              {%- endif -%}
              {%- if block.settings.author_title != blank -%}
                <p class="testimonial-card__title">{{ block.settings.author_title }}</p>
              {%- endif -%}
            </div>
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Testimonials",
  "tag": "section",
  "class": "section-testimonials",
  "settings": [
    {
      "type": "header",
      "content": "Section Header"
    },
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow text",
      "default": "Testimonials"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "What Our Customers Say"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center",
      "label": "Text alignment"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 24,
      "max": 56,
      "step": 4,
      "unit": "px",
      "default": 40,
      "label": "Heading size"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 3,
      "label": "Columns (desktop)"
    },
    {
      "type": "range",
      "id": "grid_gap",
      "min": 16,
      "max": 64,
      "step": 8,
      "unit": "px",
      "default": 32,
      "label": "Grid gap"
    },
    {
      "type": "select",
      "id": "card_style",
      "options": [
        { "value": "default", "label": "Default" },
        { "value": "rounded", "label": "Rounded corners" },
        { "value": "shadow", "label": "With shadow" }
      ],
      "default": "default",
      "label": "Card style"
    },
    {
      "type": "checkbox",
      "id": "enable_hover_effect",
      "default": true,
      "label": "Enable hover effect"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#F9F9F9",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "card_bg_color",
      "default": "#FFFFFF",
      "label": "Card background"
    },
    {
      "type": "color",
      "id": "card_border_color",
      "default": "#E5E5E5",
      "label": "Card border"
    },
    {
      "type": "color",
      "id": "eyebrow_color",
      "default": "#8B7355",
      "label": "Eyebrow color"
    },
    {
      "type": "color",
      "id": "heading_color",
      "default": "#1a1a1a",
      "label": "Heading color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#4a4a4a",
      "label": "Description color"
    },
    {
      "type": "color",
      "id": "quote_color",
      "default": "#1a1a1a",
      "label": "Quote text color"
    },
    {
      "type": "color",
      "id": "quote_mark_color",
      "default": "#8B7355",
      "label": "Quote mark color"
    },
    {
      "type": "color",
      "id": "author_name_color",
      "default": "#1a1a1a",
      "label": "Author name color"
    },
    {
      "type": "color",
      "id": "author_title_color",
      "default": "#8B7355",
      "label": "Author title color"
    },
    {
      "type": "color",
      "id": "avatar_bg_color",
      "default": "#E5E5E5",
      "label": "Avatar background"
    },
    {
      "type": "color",
      "id": "avatar_text_color",
      "default": "#8B7355",
      "label": "Avatar text color"
    },
    {
      "type": "header",
      "content": "Ratings"
    },
    {
      "type": "checkbox",
      "id": "show_ratings",
      "default": true,
      "label": "Show star ratings"
    },
    {
      "type": "color",
      "id": "star_color",
      "default": "#F59E0B",
      "label": "Star color"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "textarea",
          "id": "quote",
          "label": "Quote",
          "default": "Exceptional quality and service. The selection is outstanding and the staff truly knows their wines."
        },
        {
          "type": "range",
          "id": "rating",
          "min": 0,
          "max": 5,
          "step": 1,
          "default": 5,
          "label": "Rating (stars)"
        },
        {
          "type": "image_picker",
          "id": "avatar",
          "label": "Avatar image"
        },
        {
          "type": "text",
          "id": "author_name",
          "label": "Author name",
          "default": "Sarah Johnson"
        },
        {
          "type": "text",
          "id": "author_title",
          "label": "Author title/location",
          "default": "Wine Enthusiast"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonials",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "quote": "Exceptional quality and service. The selection is outstanding and the staff truly knows their wines.",
            "rating": 5,
            "author_name": "Sarah Johnson",
            "author_title": "Wine Enthusiast"
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "I've been a customer for years. Their curated collection never disappoints, and delivery is always prompt.",
            "rating": 5,
            "author_name": "Michael Chen",
            "author_title": "Sommelier"
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "A true gem for wine lovers. The expertise and passion shine through in every recommendation.",
            "rating": 5,
            "author_name": "Emma Thompson",
            "author_title": "San Francisco, CA"
          }
        }
      ]
    }
  ]
}
{% endschema %}
